<!DOCTYPE html>
<html lang="zh-TW">
<head>
<link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js"></script>
<meta charset="UTF-8">
  <title>ä¼‘å‡ç™»è¨˜ç³»çµ±</title>
  <style>
    body {
      font-family: Arial, "å¾®è»Ÿæ­£é»‘é«”", sans-serif;
      max-width: 700px;
      margin: auto;
      padding: 20px;
    }
    input, select, textarea, button {
      width: 100%;
      padding: 8px;
      margin-top: 6px;
      box-sizing: border-box;
    }
    button {
      background: #2c7be5;
      color: white;
      border: none;
      cursor: pointer;
      font-size: 1em;
    }
    button:hover {
      background: #1a5fc4;
    }
    iframe {
      border: 1px solid #ddd;
      margin-top: 12px;
    }
  </style>
</head>
<body>

<h2>ğŸ“ ä¼‘å‡ç™»è¨˜</h2>

<form
  action="https://docs.google.com/forms/d/e/1x4_Qp6DXdyMEwoq8cFZCSFM9XrEtUgbl3UoLKRqamb8/formResponse"
  method="POST"
  target="hidden_iframe"
  onsubmit="return showMessage()"
>

  <label>å§“å</label>
  <input type="text" name="entry.1976827451" required>

  <label>ä¼‘å‡æ—¥æœŸ</label>
  <input type="date" name="entry.1083401554" required>

  <label>å‡åˆ¥</label>
  <select name="entry.1551710315">
    <option value="ç‰¹ä¼‘">ç‰¹ä¼‘</option>
    <option value="äº‹å‡">äº‹å‡</option>
    <option value="ç—…å‡">ç—…å‡</option>
    <option value="å…¶ä»–">å…¶ä»–</option>
  </select>

  <label>å‚™è¨»</label>
  <textarea name="entry.2071643667" placeholder="optional"></textarea>

  <button type="submit">æäº¤ä¼‘å‡</button>
</form>

<iframe name="hidden_iframe" style="display:none;"></iframe>
<p id="feedback" style="color:green; font-weight:bold;"></p>

<script>
function showMessage() {
  document.getElementById("feedback").innerText = "âœ… å·²æäº¤ï¼Œæ„Ÿè¬ä½ çš„å¡«å¯«ï¼";
  return true;
}
</script>

<hr>

<h2>ğŸ“… ç›®å‰å·²ç™»è¨˜ä¼‘å‡æ¸…å–®</h2>
<hr>
<h2>ğŸ“… ä¼‘å‡æœˆæ›†</h2>
<div id="calendar"></div>

<iframe
  src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRq1zsQ8krn9aflClnTqSxI_Nsw866lq6pVdehvJAocW4hGISGPRR7BTOSBNConlCZ-UiaTnnUKMEbU/pubhtml?widget=true&headers=false"
  width="100%"
  height="400"
></iframe>

</body>
</html>
<script>
document.addEventListener('DOMContentLoaded', function () {

  const calendarEl = document.getElementById('calendar');

  fetch(
    'https://docs.google.com/spreadsheets/d/e/2PACX-1vRq1zsQ8krn9aflClnTqSxI_Nsw866lq6pVdehvJAocW4hGISGPRR7BTOSBNConlCZ-UiaTnnUKMEbU/pub?output=csv'
  )
  .then(res => res.text())
  .then(csv => {
    const rows = csv.split('\n').slice(1); // å»æ‰æ¨™é¡Œåˆ—
    const events = [];

    rows.forEach(row => {
      const cols = row.split(',');

      const name = cols[1];
      const date = cols[2];
      const type = cols[3];

      if (date) {
        events.push({
          title: `${name}ï¼ˆ${type}ï¼‰`,
          start: date,
          allDay: true
        });
      }
    });

    const calendar = new FullCalendar.Calendar(calendarEl, {
      initialView: 'dayGridMonth',
      locale: 'zh-tw',
      height: 'auto',
      events: events
    });

    calendar.render();
  });

});
</script>

