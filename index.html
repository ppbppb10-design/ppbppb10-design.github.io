<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js"></script>
  <meta charset="UTF-8" />
  <title>ä¼‘å‡ç™»è¨˜ç³»çµ±</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    body {
      font-family: "Noto Sans TC", Arial, sans-serif;
      background: #f4f6f8;
      margin: 0;
      padding: 20px;
    }

    h1, h2 {
      text-align: center;
    }

    .container {
      max-width: 900px;
      margin: auto;
    }

    .card {
      background: white;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 30px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.08);
    }

    label {
      display: block;
      margin-top: 15px;
      font-weight: bold;
    }

    input, select, textarea, button {
      width: 100%;
      margin-top: 6px;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 16px;
    }

    textarea {
      resize: vertical;
    }

    button {
      background: #4f46e5;
      color: white;
      border: none;
      margin-top: 20px;
      cursor: pointer;
    }

    button:hover {
      background: #4338ca;
    }

    iframe {
      width: 100%;
      height: 500px;
      border: none;
      border-radius: 8px;
    }

    .calendar-placeholder {
      height: 300px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #666;
      background: #fafafa;
      border: 2px dashed #ccc;
      border-radius: 10px;
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>ğŸ“… ä¼‘å‡ç™»è¨˜ç³»çµ±</h1>

    <!-- ä¼‘å‡ç™»è¨˜ -->
    <div class="card">
      <h2>ğŸ“ ä¼‘å‡ç”³è«‹</h2>

      <form
        action="https://docs.google.com/forms/u/0/d/1x4_Qp6DXdyMEwoq8cFZCSFM9XrEtUgbl3UoLKRqamb8/formResponse"

        method="POST"
        target="_self"
        onsubmit="alert('å·²é€å‡ºä¼‘å‡ç”³è«‹ï¼');"
      >
        <label>å§“å</label>
        <input type="text" name="entry.1976827451" required />

        <label>ä¼‘å‡æ—¥æœŸ</label>
        <input type="date" name="entry.1083401554" required />

        <label>å‡åˆ¥</label>
        <select name="entry.1551710315" required>
          <option value="">è«‹é¸æ“‡</option>
          <option value="ç‰¹ä¼‘">ç‰¹ä¼‘</option>
          <option value="äº‹å‡">äº‹å‡</option>
          <option value="ç—…å‡">ç—…å‡</option>
          <option value="å…¶ä»–">å…¶ä»–</option>
        </select>

        <label>å‚™è¨»</label>
        <textarea name="entry.2071643667" rows="3"></textarea>

        <button type="submit">ğŸ“¤ æäº¤ä¼‘å‡</button>
      </form>
    </div>

    <!-- å·²ç™»è¨˜æ¸…å–® -->
    <div class="card">
      <h2>ğŸ“‹ ç›®å‰å·²ç™»è¨˜ä¼‘å‡æ¸…å–®</h2>
      <iframe
        src="https://docs.google.com/spreadsheets/d/e/2PACX-1vRq1zsQ8krn9aflClnTqSxI_Nsw866lq6pVdehvJAocW4hGISGPRR7BTOSBNConlCZ-UiaTnnUKMEbU/pubhtml">
      </iframe>
    </div>

    <!-- æœˆæ›† -->
    <div class="card">
      <h2>ğŸ—“ï¸ ä¼‘å‡æœˆæ›†</h2>
     <div id="calendar"></div>

    </div>

  </div>
  <script>
document.addEventListener('DOMContentLoaded', function () {
  const calendarEl = document.getElementById('calendar');

  fetch('https://docs.google.com/spreadsheets/d/e/2PACX-1vRq1zsQ8krn9aflClnTqSxI_Nsw866lq6pVdehvJAocW4hGISGPRR7BTOSBNConlCZ-UiaTnnUKMEbU/pub?output=csv')
    .then(res => res.text())
    .then(csv => {
      const lines = csv.split('\n').slice(1);
      const events = [];

      lines.forEach(line => {
        const cols = line.match(/(".*?"|[^",\s]+)(?=\s*,|\s*$)/g);
        if (!cols || cols.length < 4) return;

        const clean = v => v.replace(/^"|"$/g, '').trim();

        const name = clean(cols[1]);
        const date = clean(cols[2]);
        const type = clean(cols[3]);
        const note = cols[4] ? clean(cols[4]) : '';

        let color = '#6366f1';
        if (type.includes('ç‰¹ä¼‘')) color = '#22c55e';
        if (type.includes('äº‹å‡')) color = '#f59e0b';
        if (type.includes('ç—…å‡')) color = '#ef4444';

        events.push({
          title: `${name}ï¼ˆ${type}ï¼‰`,
          start: date,
          allDay: true,
          color,
          extendedProps: { note }
        });
      });

      const calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'dayGridMonth',
        locale: 'zh-tw',
        height: 'auto',
        headerToolbar: {
          left: 'prev,next today',
          center: 'title',
          right: 'dayGridMonth,listMonth'
        },
        events,
        eventDidMount(info) {
          const sameDay = calendar.getEvents()
            .filter(e => e.startStr === info.event.startStr);
          if (sameDay.length >= 3) {
            info.el.style.border = '2px solid red';
          }
        },
        eventClick(info) {
          if (info.event.extendedProps.note) {
            alert('å‚™è¨»ï¼š' + info.event.extendedProps.note);
          }
        }
      });

      calendar.render();
    });
});
</script>


</body>
</html>

